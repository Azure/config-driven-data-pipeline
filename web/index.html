<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Config Driven Data Pipeline</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.1/css/bootstrap.min.css"
        integrity="sha512-siwe/oXMhSjGCwLn+scraPOWrJxHlUgMBMZXdPe2Tnk3I0x3ESCoLz7WZ5NTH6SZrywMY+PB1cjyqJ5jAluCOg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/codemirror.min.css"
        integrity="sha512-uf06llspW44/LZpHzHT6qBOIVODjWtv4MxCricRxkzvopAlSWnTf6hpZTFxuuZcuNE9CBQhqE0Seu1CoRk84nQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/theme/material.min.css"
        integrity="sha512-jA21084nir3cN96YuzJ1DbtDn30kxhxqQToAzCEGZcuRAswWfYirpUu8HVm8wRNoWDCYtA4iavd2Rb1bQSLv7g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div id="app">
        <nav class="navbar bg-light fixed-top">
            <div class="container-fluid">
                <span class="navbar-brand mb-0 h1">Config-Driven Data Pipeline WebUI</span>
                <form class="d-flex" role="search">
                    <button class="btn btn-outline-primary btn-sm mx-2" type="button"
                        @click="newPipeline()">New</button>
                    <button class="btn btn-outline-primary btn-sm mx-2" type="button"
                        @click="openFile()">Import</button>
                    <button class="btn btn-outline-primary btn-sm mx-2" v-show="selectedPipeline" type="button"
                        @click="exportPipeline()">Export</button>
                    <select class="form-select form-select-sm me-2" placeholder="Pipeline Config File"
                        aria-label="select pipeline" v-model="selectedPipeline" @change="onPipelineChanged"
                        v-if="currentPipelineObject && selectedPipeline">
                        <option v-for="pipeline in Object.keys(pipelines)" :key="pipeline" :value="pipeline">
                            {{pipelines[pipeline]['name']}}</option>
                    </select>
                    <button type="button" class="btn-close btn-sm mt-1 mx-2" aria-label="Close"
                        v-show="selectedPipeline" @click="closeFile()"></button>
                </form>
            </div>
        </nav>
        <div class="container-fluid" id="main" v-show="selectedPipeline">
            <div id="content-area" class="row align-items-start" v-show="!showCodeEditor">
                <div class="col-3 pt-1">
                    <div class="accordion " id="accordionSidebar">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingSettings">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseSettings" aria-expanded="false"
                                    aria-controls="flush-collapseSettings">
                                    Pipleline Settings
                                </button>
                            </h2>
                            <div id="flush-collapseSettings" class="accordion-collapse collapse"
                                aria-labelledby="flush-headingSettings">
                                <div class="list-group list-group-flush m-1">
                                    <button type="button"
                                        :class="'list-group-item list-group-item-action '+ ((currentPageName == 'general')?'active':'')"
                                        aria-current="true" @click="selectPage('general')">
                                        General
                                    </button>
                                    <button type="button"
                                        :class="'list-group-item list-group-item-action '+ ((currentPageName == 'databricks')?'active':'')"
                                        @click="selectPage('databricks')">Databricks</button>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingStaging">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseStaging" aria-expanded="false"
                                    aria-controls="flush-collapseStaging">
                                    Staging
                                </button>
                            </h2>
                            <div id="flush-collapseStaging" class="accordion-collapse collapse"
                                aria-labelledby="flush-headingStaging">


                                <div class="list-group list-group-flush m-1">
                                    <button type="button"
                                        class="list-group-item list-group-item-action list-group-item-light"
                                        @click="newStagingTask()" style="text-align:end">Add Task</button>
                                    <template v-if="currentPipelineObject && currentPipelineObject['staging']">
                                        <button type="button"
                                            v-for="(task, taskIdx) in currentPipelineObject['staging']"
                                            :class="'list-group-item list-group-item-action '+ ((currentPageName == 'staging' && currentPipelineStagingTask.name==task['name'])?'active':'')"
                                            @click="selectPage('staging', task['name'])">{{task['name']}}</button>
                                    </template>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingStandardization">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseStandardization" aria-expanded="false"
                                    aria-controls="flush-collapseStandardization">
                                    Standardization
                                </button>
                            </h2>
                            <div id="flush-collapseStandardization" class="accordion-collapse collapse"
                                aria-labelledby="flush-headingStandardization">
                                <div class="list-group list-group-flush m-1">
                                    <button type="button"
                                        class="list-group-item list-group-item-action list-group-item-light"
                                        @click="newStandardTask()" style="text-align:end">Add Task</button>
                                    <template v-if="currentPipelineObject && currentPipelineObject['standard']">
                                        <button type="button"
                                            v-for="(task, taskIdx) in currentPipelineObject['standard']"
                                            :class="'list-group-item list-group-item-action '+ ((currentPageName == 'standard' && currentPipelineStandardTask.name==task['name'])?'active':'')"
                                            @click="selectPage('standard', task['name'])">{{task['name']}}</button>
                                    </template>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingServing">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseServing" aria-expanded="false"
                                    aria-controls="flush-collapseServing">
                                    Serving
                                </button>
                            </h2>
                            <div id="flush-collapseServing" class="accordion-collapse collapse"
                                aria-labelledby="flush-headingServing">

                                <div class="list-group list-group-flush m-1">
                                    <button type="button"
                                        class="list-group-item list-group-item-action list-group-item-light"
                                        @click="newServingTask()" style="text-align:end">Add Task</button>
                                    <template v-if="currentPipelineObject && currentPipelineObject['serving']">
                                        <button type="button"
                                            v-for="(task, taskIdx) in currentPipelineObject['serving']"
                                            :class="'list-group-item list-group-item-action '+ ((currentPageName == 'serving' && currentPipelineServingTask.name==task['name'])?'active':'')"
                                            @click="selectPage('serving', task['name'])">{{task['name']}}</button>
                                    </template>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
                <div class="col-9">

                    <div id="config-ui-content-wrap" v-show="!showCodeEditor" v-if="currentPipelineObject"
                        class="container-fluid">


                        <div id="general-page" v-show="currentPageName=='general'">
                            <div class="container-fluid pt-2">
                                <div class="mb-3">
                                    <label for="pipelineNameField" class="form-label">Pipeline
                                        name</label>
                                    <input type="text" class="form-control form-control-sm" id="pipelineNameField"
                                        v-model="currentPipelineObject['name']" placeholder="Pipeline Name">
                                </div>
                            </div>
                        </div>
                        <div id="databricks-page" v-show="currentPageName=='databricks'">
                            <div class="container-fluid pt-2">
                                <div class="mb-3 ">
                                    <label for="dbxURL" class="form-label">Databricks
                                        URL</label>
                                    <input type="text" class="form-control form-control-sm" id="dbxURL" readonly
                                        value="https://adb-1595635774686362.2.azuredatabricks.net/">
                                </div>
                                <div class="mb-3 ">
                                    <label for="dbxURL" class="form-label">Databricks Cluster
                                        ID</label>
                                    <input type="text" class="form-control form-control-sm" id="dbxClusterId" readonly
                                        value="1021-023335-e3o079bt">
                                </div>
                                <div class="mb-3">
                                    <label for="dbxJobName" class="form-label">Databricks Job
                                        Name</label>
                                    <input type="text" class="form-control form-control-sm" id="dbxJobName"
                                        v-model="dbxJobName" :value="dbxJobName">
                                </div>
                                <div class="mb-3">
                                    <label for="workingDir" class="form-label">Working
                                        Directory</label>
                                    <input type="text" class="form-control form-control-sm" id="workingDir"
                                        v-model="workingDir" :value="workingDir">
                                </div>
                            </div>
                        </div>
                        <div id="staging-page" v-show="currentPageName=='staging'">
                            <div class="container-fluid pt-1" id="config-ui-staging-content-wrap"
                                style="overflow-x:hidden" v-if="currentPipelineStagingTask">
                                <div id="config-ui-staging-content">
                                    
                                    <div class="row m-2">
                                        <div class="col-10"></div>
                                        <button type="button" class="col-2 btn btn-outline-danger btn-sm"
                                            @click="deleteStagingTask()">Delete Task</button>
                                    </div>
                                    <form class="border p-2">
                                        <div class="row mb-3">
                                            <div class="col-6 ">
                                                <label for="config-ui-staging-name" class="form-label">Task
                                                    Name</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-name"
                                                    v-model="currentPipelineStagingTask['name']" placeholder="Name">
                                            </div>
                                        </div>
                                        <div class="row" v-if="currentPipelineStagingTask['input']">
                                            <div class="col-6 mb-3">
                                                <label for="config-ui-staging-input-type" class="form-label">Data
                                                    Source Type</label>
                                                <select class="form-select  form-select-sm"
                                                    aria-label="Data Source Type"
                                                    v-model="currentPipelineStagingTask['input']['type']"
                                                    id="config-ui-staging-input-type">
                                                    <option value="filestore">Azure Databricks
                                                        File
                                                        Store
                                                    </option>
                                                    <option value="azure_adls_gen2">ADLS Gen2
                                                    </option>
                                                    <option value="jdbc">Relation Database
                                                    </option>
                                                </select>
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='filestore'">
                                                <label for="config-ui-staging-input-format" class="form-label">File
                                                    Format</label>
                                                <select class="form-select  form-select-sm" aria-label="Format"
                                                    v-model="currentPipelineStagingTask['input']['format']"
                                                    id="config-ui-staging-nput-format">
                                                    <option value="csv">CSV
                                                    </option>
                                                    <option value="json">JSON
                                                    </option>
                                                </select>
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='filestore'">
                                                <label for="config-ui-staging-input-path" class="form-label">File
                                                    Path</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-path"
                                                    v-model="currentPipelineStagingTask['input']['path']"
                                                    placeholder="File Path">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='filestore'">
                                                <label for="config-ui-staging-input-mode" class="form-label">Data
                                                    Source Mode</label>
                                                <select class="form-select form-select-sm" aria-label="Mode"
                                                    v-model="currentPipelineStagingTask['input']['read-type']"
                                                    id="config-ui-staging-input-mode">
                                                    <option value="batch">Batch
                                                    </option>
                                                    <option value="streaming">
                                                        Streaming
                                                    </option>
                                                </select>
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='jdbc' || currentPipelineStagingTask['input']['type']=='azure_adls_gen2'">
                                                <label for="config-ui-staging-input-secret-scope"
                                                    class="form-label">Secret Scope Name</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-secret-scope"
                                                    v-model="currentPipelineStagingTask['input']['secret_scope']"
                                                    placeholder="Secret Scope Name">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='jdbc'">
                                                <label for="config-ui-staging-input-jdbc-url" class="form-label">Secret
                                                    Scope Key of JDBC
                                                    URL</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-jdbc-url"
                                                    v-model="currentPipelineStagingTask['input']['jdbc_url']"
                                                    placeholder="JDBC URL">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='jdbc'">
                                                <label for="config-ui-staging-input-jdbc-username"
                                                    class="form-label">Secret Scope Key of
                                                    Username</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-jdbc-username"
                                                    v-model="currentPipelineStagingTask['input']['jdbc_username']"
                                                    placeholder="Username">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='jdbc'">
                                                <label for="config-ui-staging-input-jdbc-password"
                                                    class="form-label">Secret Scope Key of
                                                    Password</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-jdbc-password"
                                                    v-model="currentPipelineStagingTask['input']['jdbc_password']"
                                                    placeholder="Password">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='azure_adls_gen2'">
                                                <label for="config-ui-staging-input-storage-account"
                                                    class="form-label">Secret Scope Key of
                                                    Storage
                                                    Account
                                                </label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-storage-account"
                                                    v-model="currentPipelineStagingTask['input']['storage_account']"
                                                    placeholder="Storage Account">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='azure_adls_gen2'">
                                                <label for="config-ui-staging-input-application-id"
                                                    class="form-label">Secret Scope Key of
                                                    Application
                                                    Id
                                                </label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-application-id"
                                                    v-model="currentPipelineStagingTask['input']['application_id']"
                                                    placeholder="Application Id">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='azure_adls_gen2'">
                                                <label for="config-ui-staging-input-directory-id"
                                                    class="form-label">Secret Scope Key of
                                                    Directory Id
                                                </label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-directory-id"
                                                    v-model="currentPipelineStagingTask['input']['directory_id']"
                                                    placeholder="Directory Id">
                                            </div>

                                            <div class="col-6 mb-3"
                                                v-show="currentPipelineStagingTask['input']['type']=='azure_adls_gen2'">
                                                <label for="config-ui-staging-input-service-credential-key"
                                                    class="form-label">Secret Scope Key of
                                                    Service
                                                    Credential
                                                </label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-input-service-credential-key"
                                                    v-model="currentPipelineStagingTask['input']['service_credential_key']"
                                                    placeholder="Service Credential">
                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-6 mb-3">
                                                <label for="config-ui-staging-target" class="form-label">Output
                                                    Target</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    id="config-ui-staging-target"
                                                    v-model="currentPipelineStagingTask['output']['target']"
                                                    placeholder="Target">
                                            </div>

                                            <div class="col-6 mb-3">
                                                <label for="config-ui-staging-output" class="form-label">Output
                                                    Format</label>
                                                <div>
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" type="checkbox"
                                                            id="config-ui-staging-output-table" value="table"
                                                            v-model="currentPipelineStagingTask['output']['type']">
                                                        <label class="form-check-label"
                                                            for="config-ui-staging-output-table">Table</label>
                                                    </div>
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" type="checkbox"
                                                            id="config-ui-staging-output-file" value="file"
                                                            v-model="currentPipelineStagingTask['output']['type']">
                                                        <label class="form-check-label"
                                                            for="config-ui-staging-output-file">File</label>
                                                    </div>
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" type="checkbox"
                                                            id="config-ui-staging-output-view" value="view"
                                                            v-model="currentPipelineStagingTask['output']['type']">
                                                        <label class="form-check-label"
                                                            for="config-ui-staging-output-view">View</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr />
                                        <div class="row m-2">
                                            <div class="col-10">
                                            </div>
                                            <button class="col-2 btn btn-outline-success btn-sm " type="button"
                                                @click="loadSampleData(currentPipelineStagingTask)">
                                                <span class="spinner-border spinner-border-sm" role="status"
                                                    aria-hidden="true" v-show="loadSampleDataIsRunning"></span>
                                                Import Sample Data
                                            </button>
                                        </div>

                                        <div class="row">
                                            <div class="col-12 mb-3"
                                                style="overflow-x:auto; max-height: 300px; overflow-y: auto;"
                                                v-if="currentPipelineStagingTask['schema']">
                                                <label for="schema" class="form-label">Data Source
                                                    Schema</label>
                                                <div class="border px-2 pt-2">
                                                    <div class="input-group mb-2"
                                                        v-for="(schemaItem,schemaIdx) in currentPipelineStagingTask['schema']['fields']">
                                                        <input type="text" class="form-control form-control-sm"
                                                            placeholder="Name" aria-label="Name"
                                                            v-model="currentPipelineStagingTask['schema']['fields'][schemaIdx]['name']">
                                                        <select class="form-select form-select-sm" aria-label="Type"
                                                            v-model="currentPipelineStagingTask['schema']['fields'][schemaIdx]['type']">
                                                            <option value="short">
                                                                short
                                                            </option>
                                                            <option value="integer">
                                                                integer
                                                            </option>
                                                            <option value="long">
                                                                long
                                                            </option>
                                                            <option value="float">
                                                                float
                                                            </option>
                                                            <option value="double">
                                                                double
                                                            </option>
                                                            <option value="string">
                                                                string
                                                            </option>
                                                            <option value="boolean">
                                                                boolean
                                                            </option>
                                                            <option value="boolean">
                                                                boolean
                                                            </option>
                                                            <option value="timestamp">
                                                                timestamp
                                                            </option>
                                                            <option value="date">
                                                                date
                                                            </option>
                                                        </select>
                                                        <select class="form-select form-select-sm" aria-label="Nullable"
                                                            v-model="currentPipelineStagingTask['schema']['fields'][schemaIdx]['nullable']">
                                                            <option value="false">
                                                                false
                                                            </option>
                                                            <option value="true">
                                                                true
                                                            </option>
                                                        </select>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row"
                                            v-if="currentPipelineStagingTask['sampleData'] && currentPipelineStagingTask['sampleData'].length>0">
                                            <label for="config-ui-staging-sampledata" class="form-label">Sample
                                                Data</label>
                                            <div class="col-12 mb-3">
                                                <table class="table px-2 pt-2 border">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">#
                                                            </th>
                                                            <th scope="col"
                                                                v-for="(col, colIdx) in Object.keys(currentPipelineStagingTask['sampleData'][0])"
                                                                :key="colIdx" v-html="col">
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(row, rowIdx) in currentPipelineStagingTask['sampleData']"
                                                            :key="rowIdx">
                                                            <th scope="row">
                                                                {{rowIdx}}</th>
                                                            <td v-for="(cell, cellIdx) in currentPipelineStagingTask['sampleData'][rowIdx]"
                                                                :key="cellIdx">
                                                                {{cell}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </div>
                                    </form>
                                </div>


                            </div>
                        </div>
                        <div id="standard-page" v-show="currentPageName=='standard'">
                            <div class="container-fluid pt-1" id="config-ui-standard-content-wrap"
                                v-if="currentPipelineStandardTask">
                                <div id="config-ui-standard-content">
                                    <div class="row m-2">
                                        <div class="col-10"></div>
                                        <button type="button" class="col-2 btn btn-outline-danger btn-sm"
                                            @click="deleteStandardTask()">Delete Task</button>
                                    </div>

                                    <form class="border p-3">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="mb-3">
                                                    <label for=" config-ui-standard-name" class="form-label">Task
                                                        Name</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        id="config-ui-standard-name"
                                                        v-model="currentPipelineStandardTask['name']"
                                                        placeholder="Name">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="config-ui-standard-target" class="form-label">Output
                                                        Target</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        id="config-ui-standard-target"
                                                        v-model="currentPipelineStandardTask['output']['target']"
                                                        placeholder="Target">
                                                </div>

                                                <div class="mb-3">
                                                    <label for="config-ui-standard-output" class="form-label">Output
                                                        Format</label>

                                                    <div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="config-ui-staging-output-table" value="table"
                                                                v-model="currentPipelineStandardTask['output']['type']">
                                                            <label class="form-check-label"
                                                                for="config-ui-staging-output-table">Table</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="config-ui-staging-output-file" value="file"
                                                                v-model="currentPipelineStandardTask['output']['type']">
                                                            <label class="form-check-label"
                                                                for="config-ui-staging-output-file">File</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="config-ui-staging-output-view" value="view"
                                                                v-model="currentPipelineStandardTask['output']['type']">
                                                            <label class="form-check-label"
                                                                for="config-ui-staging-output-view">View</label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="config-ui-standard-type" class="form-label">Process
                                                        Type</label>
                                                    <select class="form-select form-select-sm" aria-label="Type"
                                                        v-model="currentPipelineStandardTask['type']"
                                                        id="config-ui-standard-type">
                                                        <option value="batch">Batch
                                                        </option>
                                                        <option value="streaming">
                                                            Streaming
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="mb-3">
                                                    <label for="config-ui-standard-task-dependency" class="form-label">Upstream
                                                        Tasks</label>
                                                    <select multiple class="form-select form-select-sm"
                                                        aria-label="Upstream Tasks"
                                                        v-model="currentPipelineStandardTask['dependency']"
                                                        id="config-ui-standard-task-dependency" style="height:260px">
                                                        <option
                                                            v-for="(task, taskIdx) in currentPipelineObject['standard']"
                                                            v-if="task['name']!=currentPipelineStandardTask['name'] && task['type']=='batch'"
                                                            :selected="currentPipelineStandardTask['dependency'].indexOf(task['name'])!=-1"
                                                            :value="task['name']">{{task['name']}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>

                                        </div>

                                        <div class="col-12 mb-3">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="codeModeOptions"
                                                    id="stdCodeMode1"
                                                    v-model="currentPipelineStandardTask['code']['lang']" value="sql"
                                                    @change="onStandardCodeTypeChanged">
                                                <label class="form-check-label" for="stdCodeMode1">SQL</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="codeModeOptions"
                                                    id="stdCodeMode2"
                                                    v-model="currentPipelineStandardTask['code']['lang']" value="python"
                                                    @change="onStandardCodeTypeChanged">
                                                <label class="form-check-label" for="stdCodeMode2">Python</label>
                                            </div>
                                            <div id="config-ui-standard-sql-wrapper"
                                                style="height:300px;width: 100%; overflow:auto"
                                                v-show="currentPipelineStandardTask['code']['lang']=='sql'">
                                                <div class="form-control form-control-sm"
                                                    style="height:100%;width: 100%;" id="config-ui-standard-sql">
                                                </div>
                                            </div>
                                            <div id="config-ui-standard-py-wrapper"
                                                style="height:300px;width: 100%; overflow:auto"
                                                v-show="currentPipelineStandardTask['code']['lang']=='python'">
                                                <div class="form-control form-control-sm"
                                                    style="height:100%;width: 100%;" id="config-ui-standard-python">
                                                </div>
                                            </div>

                                            <div class="row m-2">
                                                <div class="col-10">
                                                </div>

                                                <button class="btn btn-sm btn-outline-primary col-2" type="button"
                                                    @click="tryStandardTask(currentPipelineStandardTask)">
                                                    <span class="spinner-border spinner-border-sm" role="status"
                                                        aria-hidden="true"
                                                        v-show="currentPipelineStandardTaskIsRunning"></span>
                                                    Try It</button>

                                            </div>

                                            <div class="mb-3">
                                                <table class="table border"
                                                    v-if="results['standard'] && results['standard'][currentPipelineStandardTask['name']] && results['standard'][currentPipelineStandardTask['name']].length>0">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">#
                                                            </th>
                                                            <th scope="col"
                                                                v-for="(col, colIdx) in Object.keys(results['standard'][currentPipelineStandardTask['name']][0])"
                                                                :key="colIdx" v-html="col">
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(row, rowIdx) in results['standard'][currentPipelineStandardTask['name']]"
                                                            :key="rowIdx">
                                                            <th scope="row">
                                                                {{rowIdx}}</th>
                                                            <td v-for="(cell, cellIdx) in results['standard'][currentPipelineStandardTask['name']][rowIdx]"
                                                                :key="cellIdx">
                                                                {{cell}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div id="serving-page" v-show="currentPageName=='serving'">
                            <div class="container-fluid pt-1" id="config-ui-serving-content-wrap"
                                v-if="currentPipelineServingTask">
                                <div id="config-ui-serving-content">
                                    <div class="row m-2">
                                        <div class="col-10"></div>
                                        <button type="button" class="col-2 btn btn-outline-danger btn-sm"
                                            @click="deleteServingTask()">Delete Task</button>
                                    </div>

                                    <form class="border p-3">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="mb-3">
                                                    <label for="config-ui-serving-name" class="form-label">Task
                                                        Name</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        id="config-ui-serving-name"
                                                        v-model="currentPipelineServingTask['name']" placeholder="Name">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="config-ui-serving-target" class="form-label">Output
                                                        Target</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        id="config-ui-serving-target"
                                                        v-model="currentPipelineServingTask['output']['target']"
                                                        placeholder="Target">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="config-ui-serving-output" class="form-label">Output
                                                        Format</label>
                                                    <div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="config-ui-staging-output-table" value="table"
                                                                v-model="currentPipelineServingTask['output']['type']">
                                                            <label class="form-check-label"
                                                                for="config-ui-staging-output-table">Table</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="config-ui-staging-output-file" value="file"
                                                                v-model="currentPipelineServingTask['output']['type']">
                                                            <label class="form-check-label"
                                                                for="config-ui-staging-output-file">File</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="config-ui-staging-output-view" value="view"
                                                                v-model="currentPipelineServingTask['output']['type']">
                                                            <label class="form-check-label"
                                                                for="config-ui-staging-output-view">View</label>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="mb-3">
                                                    <label for="config-ui-serving-type" class="form-label">Process
                                                        Type</label>
                                                    <select class="form-select form-select-sm" aria-label="Type"
                                                        v-model="currentPipelineServingTask['type']"
                                                        id="config-ui-serving-type">
                                                        <option value="batch">Batch
                                                        </option>
                                                        <option value="streaming">
                                                            Streaming
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="mb-3">
                                                    <label for="config-ui-serving-task-dependency" class="form-label">Upstream
                                                        Tasks</label>
                                                    <select multiple class="form-select form-select-sm"
                                                        aria-label="Upstream Tasks"
                                                        v-model="currentPipelineServingTask['dependency']"
                                                        id="config-ui-serving-task-dependency" style="height:260px">
                                                        <option
                                                            v-for="(task, taskIdx) in currentPipelineObject['serving']"
                                                            v-if="task['name']!=currentPipelineServingTask['name'] && task['type']=='batch'"
                                                            :selected="currentPipelineServingTask['dependency'].indexOf(task['name'])!=-1"
                                                            :value="task['name']">{{task['name']}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>

                                        </div>





                                        <div class="col-12 mb-3">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="codeModeOptions"
                                                    id="stdCodeMode1"
                                                    v-model="currentPipelineServingTask['code']['lang']"
                                                    @change="onServingCodeTypeChanged" value="sql">
                                                <label class="form-check-label" for="stdCodeMode1">SQL</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="codeModeOptions"
                                                    id="stdCodeMode2"
                                                    v-model="currentPipelineServingTask['code']['lang']"
                                                    @change="onServingCodeTypeChanged" value="python">
                                                <label class="form-check-label" for="stdCodeMode2">Python</label>
                                            </div>
                                            <div id="config-ui-serving-sql-wrapper"
                                                style="height:300px;width: 100%; overflow:auto"
                                                v-show="currentPipelineServingTask['code']['lang']=='sql'">
                                                <div class="form-control form-control-sm"
                                                    style="height:100%;width: 100%;" id="config-ui-serving-sql">
                                                </div>
                                            </div>
                                            <div id="config-ui-serving-py-wrapper"
                                                style="height:300px;width: 100%; overflow:auto"
                                                v-show="currentPipelineServingTask['code']['lang']=='python'">
                                                <div class="form-control form-control-sm"
                                                    style="height:100%;width: 100%;" id="config-ui-serving-python">
                                                </div>
                                            </div>


                                            <div class="row m-2">
                                                <div class="col-10">
                                                </div>

                                                <button class="btn btn-sm btn-outline-primary col-2" type="button"
                                                    @click="tryServingTask(currentPipelineServingTask)">
                                                    <span class="spinner-border spinner-border-sm" role="status"
                                                        aria-hidden="true"
                                                        v-show="currentPipelineServingTaskIsRunning"></span>
                                                    Try It</button>

                                            </div>

                                            <div class="mb-3">
                                                <table class="table px-2 pt-2  border"
                                                    v-if="results['serving'] && results['serving'][currentPipelineServingTask['name']] && results['serving'][currentPipelineServingTask['name']].length>0">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">#
                                                            </th>
                                                            <th scope="col"
                                                                v-for="(col, colIdx) in Object.keys(results['serving'][currentPipelineServingTask['name']][0])"
                                                                :key="colIdx" v-html="col">
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(row, rowIdx) in results['serving'][currentPipelineServingTask['name']]"
                                                            :key="rowIdx">
                                                            <th scope="row">
                                                                {{rowIdx}}</th>
                                                            <td v-for="(cell, cellIdx) in results['serving'][currentPipelineServingTask['name']][rowIdx]"
                                                                :key="cellIdx">
                                                                {{cell}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="config-json-content-wrap" v-show="showCodeEditor">
                <div id="config-json-content"></div>
            </div>
            <div class="row mt-2 border-top">
                <div class="col">
                    <div class="form-check form-switch mt-3">
                        <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault"
                            @change="toggleCodeEditor()">
                        <label class="form-check-label" for="flexSwitchCheckDefault">Code
                            Editor</label>
                    </div>
                </div>
                <div class="col" style="text-align: right;">
                    <button type="button" class="btn btn-outline-primary btn btn-sm mt-2 mx-2" @click="showPreview()">
                        Preview
                    </button>
                    <button class="btn btn-outline-primary btn btn-sm mt-2 mx-2" type="button"
                        @click="deployPipeline(false)">
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"
                            v-show="deployIsRunning"></span>
                        Deploy</button>
                    <button class="btn btn-outline-primary btn btn-sm mt-2 mx-2" type="button"
                        @click="deployPipeline(true)">
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"
                            v-show="deployAndRunIsRunning"></span>
                        Deploy & Run</button>
                </div>
            </div>
        </div>

        <div class="modal fade " id="previewModal" tabindex="-1" aria-labelledby="previewModalLabel" aria-hidden="true"
            style="height:100%;overflow:hidden">
            <div class="modal-dialog modal-fullscreen" style="height:100%;overflow:hidden">
                <div class="modal-content" style="height:100%;overflow:hidden">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="previewModalLabel">Pipeline Preview</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="height:100%;overflow:hidden">

                        <div class="container-fluid" style="height:100%;overflow:hidden">
                            <div class="row" style="height:100%;overflow:hidden">
                                <div class="col" style="text-align: center;height:100%;width:100%;overflow:auto">
                                    <vue-mermaid-string v-if="previewDiagram" :value="previewDiagram" />
                                </div>
                                <div class="col" style="height:100%;overflow:hidden">
                                    <div id="workflow-json-preview-area-wrap"
                                        style="height:100%;width:100%;overflow:hidden">
                                        <div id="workflow-json-preview-area"
                                            style="height:100%;width:100%;overflow:hidden">
                                            <pre class="border"
                                                style="height:100%;overflow:auto"><code>{{previewWorkflowJson}}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.1/js/bootstrap.min.js"
        integrity="sha512-vyRAVI0IEm6LI/fVSv/Wq/d0KUfrg3hJq2Qz5FlfER69sf3ZHlOrsLriNm49FxnpUGmhx+TaJKwJ+ByTLKT+Yg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/codemirror.min.js"
        integrity="sha512-Kpi2Sp2KpXM2S7aM0p+CwWhm8NuogI15GFPXCmgqAnFr5c86VBXuLEZu0IGBwGSdhhTW6148hP9KTcRMmrjuFQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/mode/javascript/javascript.min.js"
        integrity="sha512-I6CdJdruzGtvDyvdO4YsiAq+pkWf2efgd1ZUSK2FnM/u2VuRASPC7GowWQrWyjxCZn6CT89s3ddGI+be0Ak9Fg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/mode/sql/sql.min.js"
        integrity="sha512-JOURLWZEM9blfKvYn1pKWvUZJeFwrkn77cQLJOS6M/7MVIRdPacZGNm2ij5xtDV/fpuhorOswIiJF3x/woe5fw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/mode/python/python.min.js"
        integrity="sha512-RT0AjIFvx/vuD2Ih9pmIOhlU+HNTpTHGMJ7TORv4oTT0yHqbz9BicxiBohrq84kjvpHnXtWg/wjG0kisHh4EOA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.7.10/vue.min.js"
        integrity="sha512-H8u5mlZT1FD7MRlnUsODppkKyk+VEiCmncej8yZW1k/wUT90OQon0F9DSf/2Qh+7L/5UHd+xTLrMszjHEZc2BA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"
        integrity="sha512-odNmoc1XJy5x1TMVMdC7EMs3IVdItLPlCeL5vSUPN2llYKMJ2eByTTAIiiuqLg+GdNr9hF6z81p27DArRFKT7A=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://unpkg.com/mermaid@9/dist/mermaid.min.js"></script>
    <script src="https://unpkg.com/vue-mermaid-string@3"></script>
    <script src="index.js"></script>
</body>

</html>