{
    "name": "nyc_taxi",
    "staging": [
      {
        "name": "nyc_taxi_raw",
        "target": "stg_untitled1",
        "input": {
          "type": "filestore",
          "format": "csv",
          "path": "stg_data1/",
          "read-type": "batch",
          "schema": {}
        },
        "output": {
          "target": "nyc_taxi_raw",
          "type": [
            "file",
            "view"
          ]
        },
        "schema": {
          "fields": [
            {
              "metadata": {},
              "name": "_c0",
              "nullable": true,
              "type": "integer"
            },
            {
              "metadata": {},
              "name": "Unnamed:_0",
              "nullable": true,
              "type": "integer"
            },
            {
              "metadata": {},
              "name": "VendorID",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "tpep_pickup_datetime",
              "nullable": true,
              "type": "timestamp"
            },
            {
              "metadata": {},
              "name": "tpep_dropoff_datetime",
              "nullable": true,
              "type": "timestamp"
            },
            {
              "metadata": {},
              "name": "passenger_count",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "trip_distance",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "RatecodeID",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "store_and_fwd_flag",
              "nullable": true,
              "type": "string"
            },
            {
              "metadata": {},
              "name": "PULocationID",
              "nullable": true,
              "type": "integer"
            },
            {
              "metadata": {},
              "name": "DOLocationID",
              "nullable": true,
              "type": "integer"
            },
            {
              "metadata": {},
              "name": "payment_type",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "fare_amount",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "extra",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "mta_tax",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "tip_amount",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "tolls_amount",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "improvement_surcharge",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "total_amount",
              "nullable": true,
              "type": "double"
            },
            {
              "metadata": {},
              "name": "congestion_surcharge",
              "nullable": true,
              "type": "double"
            }
          ],
          "type": "struct"
        },
        "sampleData": [
          {
            "_c0": 0,
            "Unnamed:_0": 0,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T06:43:32.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T06:50:34.000+08:00",
            "passenger_count": 1,
            "trip_distance": 1.77,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 186,
            "DOLocationID": 161,
            "payment_type": 1,
            "fare_amount": 7.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 2.16,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 12.96,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 1,
            "Unnamed:_0": 1,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T06:24:06.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T06:34:26.000+08:00",
            "passenger_count": 1,
            "trip_distance": 5.59,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 143,
            "DOLocationID": 244,
            "payment_type": 1,
            "fare_amount": 17.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 2,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 22.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 2,
            "Unnamed:_0": 2,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T10:24:37.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T10:37:33.000+08:00",
            "passenger_count": 1,
            "trip_distance": 3.79,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 238,
            "DOLocationID": 161,
            "payment_type": 2,
            "fare_amount": 13.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 16.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 3,
            "Unnamed:_0": 3,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T10:30:25.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T10:38:07.000+08:00",
            "passenger_count": 1,
            "trip_distance": 1.4,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 68,
            "DOLocationID": 137,
            "payment_type": 2,
            "fare_amount": 7.5,
            "extra": 2.5,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 10.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 4,
            "Unnamed:_0": 4,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T11:31:13.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T11:39:15.000+08:00",
            "passenger_count": 1,
            "trip_distance": 1.8,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 141,
            "DOLocationID": 236,
            "payment_type": 1,
            "fare_amount": 8,
            "extra": 2.5,
            "mta_tax": 0.5,
            "tip_amount": 2.7,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 14,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 5,
            "Unnamed:_0": 5,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T11:42:57.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T11:49:40.000+08:00",
            "passenger_count": 1,
            "trip_distance": 0.5,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 75,
            "DOLocationID": 75,
            "payment_type": 1,
            "fare_amount": 6,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 2,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 8.8,
            "congestion_surcharge": 0
          },
          {
            "_c0": 6,
            "Unnamed:_0": 6,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T11:19:58.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T11:38:20.000+08:00",
            "passenger_count": 1,
            "trip_distance": 3.63,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 43,
            "DOLocationID": 100,
            "payment_type": 2,
            "fare_amount": 15.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 18.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 7,
            "Unnamed:_0": 7,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T12:40:05.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T12:44:45.000+08:00",
            "passenger_count": 1,
            "trip_distance": 0.8,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 249,
            "DOLocationID": 249,
            "payment_type": 1,
            "fare_amount": 5.5,
            "extra": 2.5,
            "mta_tax": 0.5,
            "tip_amount": 1.75,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 10.55,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 8,
            "Unnamed:_0": 8,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T12:38:39.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T12:46:52.000+08:00",
            "passenger_count": 2,
            "trip_distance": 1.06,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 263,
            "DOLocationID": 75,
            "payment_type": 2,
            "fare_amount": 6.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 7.3,
            "congestion_surcharge": 0
          },
          {
            "_c0": 9,
            "Unnamed:_0": 9,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T12:02:09.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T12:10:12.000+08:00",
            "passenger_count": 1,
            "trip_distance": 0.91,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 232,
            "DOLocationID": 79,
            "payment_type": 2,
            "fare_amount": 6.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 9.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 10,
            "Unnamed:_0": 10,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T12:31:44.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T12:49:45.000+08:00",
            "passenger_count": 2,
            "trip_distance": 6.39,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 186,
            "DOLocationID": 41,
            "payment_type": 2,
            "fare_amount": 21,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 24.3,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 11,
            "Unnamed:_0": 11,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T13:19:35.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T13:54:18.000+08:00",
            "passenger_count": 1,
            "trip_distance": 10.47,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 43,
            "DOLocationID": 25,
            "payment_type": 1,
            "fare_amount": 33.5,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 7.36,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 44.16,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 12,
            "Unnamed:_0": 12,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T13:11:03.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T13:19:43.000+08:00",
            "passenger_count": 1,
            "trip_distance": 1.36,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 262,
            "DOLocationID": 233,
            "payment_type": 1,
            "fare_amount": 8,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 2.26,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 13.56,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 13,
            "Unnamed:_0": 13,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T13:00:10.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T13:39:18.000+08:00",
            "passenger_count": 1,
            "trip_distance": 0,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 107,
            "DOLocationID": 71,
            "payment_type": 1,
            "fare_amount": 32.2,
            "extra": 0,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 33,
            "congestion_surcharge": 0
          },
          {
            "_c0": 14,
            "Unnamed:_0": 14,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T14:44:37.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T14:51:13.000+08:00",
            "passenger_count": 1,
            "trip_distance": 1.2,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 238,
            "DOLocationID": 151,
            "payment_type": 1,
            "fare_amount": 6.5,
            "extra": 2.5,
            "mta_tax": 0.5,
            "tip_amount": 1.95,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 11.75,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 15,
            "Unnamed:_0": 15,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T15:24:50.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T15:33:30.000+08:00",
            "passenger_count": 1,
            "trip_distance": 2.3,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 151,
            "DOLocationID": 142,
            "payment_type": 1,
            "fare_amount": 9.5,
            "extra": 2.5,
            "mta_tax": 0.5,
            "tip_amount": 2.55,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 15.35,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 16,
            "Unnamed:_0": 16,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T15:18:35.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T15:33:33.000+08:00",
            "passenger_count": 1,
            "trip_distance": 2.8,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 170,
            "DOLocationID": 143,
            "payment_type": 1,
            "fare_amount": 12.5,
            "extra": 2.5,
            "mta_tax": 0.5,
            "tip_amount": 2,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 17.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 17,
            "Unnamed:_0": 17,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T16:38:34.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T16:45:29.000+08:00",
            "passenger_count": 1,
            "trip_distance": 2.1,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 162,
            "DOLocationID": 236,
            "payment_type": 1,
            "fare_amount": 8,
            "extra": 3.5,
            "mta_tax": 0.5,
            "tip_amount": 3.65,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 15.95,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 18,
            "Unnamed:_0": 18,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T16:27:56.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T16:33:03.000+08:00",
            "passenger_count": 0,
            "trip_distance": 0.4,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 209,
            "DOLocationID": 209,
            "payment_type": 3,
            "fare_amount": 5,
            "extra": 3.5,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 9.3,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 19,
            "Unnamed:_0": 19,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T17:31:51.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T17:36:04.000+08:00",
            "passenger_count": 1,
            "trip_distance": 0.5,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 74,
            "DOLocationID": 41,
            "payment_type": 2,
            "fare_amount": 4.5,
            "extra": 1,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 6.3,
            "congestion_surcharge": 0
          },
          {
            "_c0": 20,
            "Unnamed:_0": 20,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T17:10:06.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T17:25:29.000+08:00",
            "passenger_count": 1,
            "trip_distance": 4.3,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 170,
            "DOLocationID": 238,
            "payment_type": 1,
            "fare_amount": 15.5,
            "extra": 3.5,
            "mta_tax": 0.5,
            "tip_amount": 2.97,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 22.77,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 21,
            "Unnamed:_0": 21,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T19:03:12.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T19:05:34.000+08:00",
            "passenger_count": 1,
            "trip_distance": 0.4,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 186,
            "DOLocationID": 234,
            "payment_type": 2,
            "fare_amount": 4,
            "extra": 3.5,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 8.3,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 22,
            "Unnamed:_0": 22,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T19:59:01.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T20:15:50.000+08:00",
            "passenger_count": 3,
            "trip_distance": 6.1,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 41,
            "DOLocationID": 224,
            "payment_type": 2,
            "fare_amount": 20,
            "extra": 3,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 23.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 23,
            "Unnamed:_0": 23,
            "VendorID": 2,
            "tpep_pickup_datetime": "2020-06-01T20:04:05.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T20:14:40.000+08:00",
            "passenger_count": 1,
            "trip_distance": 7.85,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 232,
            "DOLocationID": 74,
            "payment_type": 1,
            "fare_amount": 22,
            "extra": 0.5,
            "mta_tax": 0.5,
            "tip_amount": 0,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 25.8,
            "congestion_surcharge": 2.5
          },
          {
            "_c0": 24,
            "Unnamed:_0": 24,
            "VendorID": 1,
            "tpep_pickup_datetime": "2020-06-01T21:57:46.000+08:00",
            "tpep_dropoff_datetime": "2020-06-01T22:06:50.000+08:00",
            "passenger_count": 0,
            "trip_distance": 2.9,
            "RatecodeID": 1,
            "store_and_fwd_flag": "N",
            "PULocationID": 229,
            "DOLocationID": 7,
            "payment_type": 1,
            "fare_amount": 11,
            "extra": 3,
            "mta_tax": 0.5,
            "tip_amount": 5,
            "tolls_amount": 0,
            "improvement_surcharge": 0.3,
            "total_amount": 19.8,
            "congestion_surcharge": 2.5
          }
        ]
      }
    ],
    "standard": [
      {
        "name": "nyc_taxi_dataset_std_1",
        "code": {
          "lang": "sql",
          "sql": "SELECT\n            trip_distance,\n            total_amount,\n            to_date(tpep_pickup_datetime, 'yyyy-MM-dd HH:mm:ss')  AS pickup_date, \n            to_unix_timestamp(tpep_dropoff_datetime, 'yyyy-MM-dd HH:mm:ss')\n            -to_unix_timestamp(tpep_pickup_datetime, 'yyyy-MM-dd HH:mm:ss')  AS trip_duration,\n            round(trip_distance/((to_unix_timestamp(tpep_dropoff_datetime, 'yyyy-MM-dd HH:mm:ss')\n            -to_unix_timestamp(tpep_pickup_datetime, 'yyyy-MM-dd HH:mm:ss') ) )*3600, 2) AS speed,\n            from_unixtime(unix_timestamp(tpep_pickup_datetime, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:00') \n            pickup_date_time,\n            hour(tpep_pickup_datetime) as pickup_hour, \n            minute(tpep_pickup_datetime) as pickup_minute, \n            floor(minute(tpep_pickup_datetime)/10) as pickup_timeslot,\n            PULocationID pickup_loc\n        FROM\n            nyc_taxi_raw\n        WHERE \n            trip_distance>0",
          "python": "output_df = spark.sql('select now() as ts')"
        },
        "type": "batch",
        "output": {
          "target": "nyc_taxi_dataset_std_1",
          "type": [
            "file",
            "view"
          ]
        }
      },
      {
        "name": "nyc_taxi_dataset_std_2",
        "code": {
          "lang": "sql",
          "sql": "        WITH bounds  AS (\n            select  \n                percentile_approx(trip_distance, 0.001) AS trip_distance_lower_bound,\n                percentile_approx(trip_distance, 0.999) AS trip_distance_upper_bound,\n                percentile_approx(speed, 0.001) AS speed_lower_bound,\n                percentile_approx(speed, 0.999) AS speed_upper_bound,\n                percentile_approx(total_amount, 0.001) AS total_amount_lower_bound,\n                percentile_approx(total_amount, 0.999) AS total_amount_upper_bound\n            from \n                nyc_taxi_dataset_std_1\n        )\n        SELECT\n             nyc_taxi_dataset_std_1.*\n        FROM\n             nyc_taxi_dataset_std_1, bounds\n        WHERE \n            trip_distance BETWEEN trip_distance_lower_bound AND trip_distance_upper_bound\n            and trip_duration>0 and trip_duration<72*60*60\n            and speed>0 and speed BETWEEN speed_lower_bound AND speed_upper_bound\n            and total_amount>0 and total_amount BETWEEN total_amount_lower_bound AND total_amount_upper_bound",
          "python": "output_df = spark.sql('select now() as ts')"
        },
        "type": "batch",
        "output": {
          "target": "nyc_taxi_dataset_std_2",
          "type": [
            "file",
            "view"
          ]
        }
      },
      {
        "name": "nyc_taxi_dataset_std_3",
        "code": {
          "lang": "sql",
          "sql": "SELECT \n            pickup_date,\n            pickup_loc,\n            pickup_hour,\n            pickup_minute,\n            pickup_timeslot,\n            pickup_date_time,\n            count(*) as pickup_count,\n            trip_distance>15 as long_distance,\n            sum(trip_duration) as sum_trip_duration,\n            min(trip_duration) as min_trip_duration,\n            max(trip_duration) as max_trip_duration,\n            sum(trip_distance) as sum_trip_distance,\n            min(trip_distance) as min_trip_distance,\n            max(trip_distance) as max_trip_distance,\n            sum(total_amount) as sum_trip_fare_amount,\n            min(total_amount) as min_trip_fare_amount,\n            max(total_amount) as max_trip_fare_amount,\n            min(speed) as min_speed,\n            max(speed) as max_speed,\n            avg(speed) as avg_speed\n        FROM\n            nyc_taxi_dataset_std_2\n        group by\n            pickup_date,\n            pickup_hour,\n            pickup_minute,\n            pickup_timeslot,\n            pickup_date_time,\n            pickup_loc ,\n            long_distance",
          "python": "output_df = spark.sql('select now() as ts')"
        },
        "type": "batch",
        "output": {
          "target": "nyc_taxi_dataset_std_3",
          "type": [
            "file",
            "view"
          ]
        }
      }
    ],
    "serving": [
      {
        "name": "nyc_taxi_dataset_curation_1",
        "code": {
          "lang": "sql",
          "sql": "        SELECT\n            pickup_date,\n            pickup_loc,\n            long_distance,\n            sum(pickup_count) AS pickup_count,\n            sum(sum_trip_duration) AS sum_trip_duration,\n            sum(sum_trip_distance) AS sum_trip_distance,\n            sum(sum_trip_fare_amount) AS sum_trip_fare_amount\n       FROM\n            nyc_taxi_dataset_std_3\n        GROUP BY\n            pickup_date,\n            pickup_loc,\n            long_distance",
          "python": "output_df = spark.sql('select now() as ts')"
        },
        "type": "batch",
        "output": {
          "target": "nyc_taxi_dataset_curation_1",
          "type": [
            "file",
            "view"
          ]
        }
      }
    ]
  }