{
    "name": "fruit_batch_data_app",
    "staging": [
      {
        "name": "sales_ingestion",
        "target": "stg_sales",
        "input": {
          "type": "azure_adf",
          "format": "csv",
          "path": "FileStore/cddp_apps/fruit_batch_data_app/landing/sales_ingestion/",
          "read-type": "batch",
          "schema": {
            "fields": [
              {
                "metadata": {},
                "name": "ID",
                "nullable": true,
                "type": "integer"
              },
              {
                "metadata": {},
                "name": "Amount",
                "nullable": true,
                "type": "integer"
              },
              {
                "metadata": {},
                "name": "TS",
                "nullable": true,
                "type": "timestamp"
              }
            ],
            "type": "struct"
          },
          "secret_scope": "cddp_kv",
          "storage_account": "lsgcdls",
          "storage_account_access_key": "sp-storage-account-access-key",
          "application_id": "sp-application-id",
          "service_credential_key": "sp-service-credential",
          "subscription_id":"sp-subscription-id",
          "directory_id": "sp-directory-id",
          "rg_name": "lsgc",
          "df_name": "lsgcadf",
          "p_name": "Data Landing Pipeline",
          "container_name": "test",
          "data_folder": "fruit-sales"
        },
        "output": {
          "target": "stg_sales",
          "type": [
            "file",
            "view"
          ]
        },
        "schema": {
          "fields": [
            {
              "metadata": {},
              "name": "ID",
              "nullable": true,
              "type": "integer"
            },
            {
              "metadata": {},
              "name": "Amount",
              "nullable": true,
              "type": "integer"
            },
            {
              "metadata": {},
              "name": "TS",
              "nullable": true,
              "type": "timestamp"
            }
          ],
          "type": "struct"
        }
      }
    ],
    "standard": [
      {
        "name": "fruit_sales_transform",
        "type": "batch",
        "code": {
          "lang": "sql",
          "sql": "select price.fruit, price.id, sales.amount, price.price, sales.ts from stg_sales sales left outer join stg_price price on sales.id = price.id and sales.ts >= price.start_ts and sales.ts < price.end_ts"
        },
        "output": {
          "target": "std_fruit_sales",
          "type": [
            "file",
            "view"
          ]
        }
      }
    ],
    "serving": [
      {
        "name": "fruit_sales_total_curation",
        "type": "batch",
        "code": {
          "lang": "sql",
          "sql": "select id, fruit, sum(amount*price) as total from std_fruit_sales group by id, fruit order by total desc"
        },
        "output": {
          "target": "srv_fruit_sales_total",
          "type": [
            "table",
            "file"
          ]
        }
      }
    ]
  }